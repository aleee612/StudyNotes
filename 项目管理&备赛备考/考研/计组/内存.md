### DRAM刷新方式
|特征|集中刷新|分散刷新|异步刷新|
|---|---|---|---|
|刷新方式|所有存储单元同时刷新|根据存储单元的需求刷新|根据使用情况和需求刷新|
|性能影响|可能导致性能下降，因为刷新操作同时进行|最小程度影响性能，仅刷新需要刷新的存储单元|最小程度影响性能，根据实际使用情况调整刷新操作|
|硬件要求|硬件和控制器相对简单|需要更复杂的硬件和控制器|需要智能的内存控制器和硬件支持|
|能源效率|可能相对较低|较高，因为只刷新需要刷新的存储单元|较高，因为根据需求动态调整刷新频率|
|寿命|可能影响寿命，特别是对于不经常使用的存储单元|可以延长内存寿命|可以延长内存寿命|
|灵活性|有限的灵活性|更大的灵活性|高度灵活，可根据使用情况自动调整刷新频率|
### 多模块存储器
- 针对对象：存储模块
- 作用：提高存储器的 **吞吐率**
- 主要技术：并行
#### 单体多字存储器
按同一地址码并行地访问各自对应单元，每一个单元为一个字，每字 **m 位**。可以同时选中存储器的 **n 个单元**，可以将带宽提高 **n 倍**
- 没有并行模块
- 快在“一次多拿”
	一次访存
	→ 得到 A, A+1, A+2, A+3
#### 多体交叉存储器
- 采用 **交叉编址** 的方式将主存划分为多个 **存储体**
- 通过多个存储体达到并行的效果
##### 高位交叉编址
![[Pasted image 20260201164551.png]]
- 即**地址的高位** 用于选择 **存储体**，**低位** 表示在该存储体中的偏移地址。
特点：
- 连续存储
- 相邻地址在同一存储体
缺点：
- 相邻数据集中在一个存储体中，**多个存储体无法并行工作**，而是 **串行工作**
- 所有存储体共用一个 **地址寄存器（AR）** 和 **数据寄存器（DR）**
- 每次只能访问一个存储体，其它存储体处于空闲状态 
##### 低位交叉编址
- **低位** 用于选择 **存储体**，**高位** 用于标识该存储体内的偏移地址

| 地址  | 二进制  | 模块号 |
| --- | ---- | --- |
| 0   | 0000 | 0   |
| 1   | 0001 | 1   |
| 2   | 0010 | 2   |
| 3   | 0011 | 3   |
| 4   | 0100 | 0   |
| 5   | 0101 | 1   |
- 如此时一共有 4 个模块，模块号用地址的 **低 2 位** 决定
优点：
- 实现了 **相邻地址** 分散存储在不同存储体中的效果
- 可以并行
缺点：
- 每个存储体都需配备自己的地址寄存器和数据寄存器
###### 计算方式：
模块序号 = 访存地址 % 存储器交叉模块数
冲突：给定的访存地址在**相邻**的n次访问中出现在同一个存储模块内
##### 并行性
**存储周期**：
- 某个存储体完成一次数据读/写后，必须等待一定时间后才能再次被访问，而这整个过程被称为存储周期
- 整个系统的 最小连续访问间隔 = 存储周期 / 存储体数目
**采用流水线方式：**
- 即使存储体尚未完成其自身内部访问，也可以开始对其他体的下一条指令进行地址投送，实现访问阶段的 **重叠执行**，从而提升 **吞吐率**
#### 主存容量的扩展
- 假设存储芯片的字长为 N ，存储字数为 M ，则存储芯片的容量为 M×N
- 常见存储扩展：位扩展（字长）、字扩展（字数）、字位扩展（同时）
![[Pasted image 20260201170340.png]]
##### 位扩展
- 在 **存储字数不变** 的前提下，
	通过 **并联** 多个存储芯片来增加**字长**
- 所有芯片的**地址线**完全相同
- 原来：
	`[ b7 b6 b5 b4 b3 b2 b1 b0 ]  ← 8 位`
- 位扩展后（比如扩成 16 位）：
	`[ b15 … b8 ] + [ b7 … b0 ]    芯片B + 芯片A`
	 **同一个地址**  
	 **不同芯片各负责一部分位**
##### 字扩展
- 在 **字长不变** 的前提下，  
    通过**增加**存储芯片**数量** + 地址译码来增加存储**字数**
- 所有芯片的 **数据线** 完全相同
- **低位地址线** 接到所有芯片  
    **高位地址线** 用于 **片选**
- 原来：
	`A0 ~ A7 [ b7 b6 b5 b4 b3 b2 b1 b0 ]   ← 8 位 256 字`
- 字扩展后（比如扩成 1K × 8）：
	`A0 ~ A7   → 所有芯片 A8 ~ A9   → 译码器 → 选不同芯片 `
		同一时刻 只启用一个芯片
##### 字位扩展
- 在 **同时增加字数和字长** 的情况下  
    结合 **字扩展 + 位扩展**
- **低位地址线** 接所有芯片
- **高位地址线** 负责片选
- **同一地址下多个芯片并行输出不同位**
- 原来：
	`256 × 8 [ b7 b6 b5 b4 b3 b2 b1 b0 ]`
- 字位扩展后（比如扩成 1K × 16）：
```
        同一地址
        ↓
[ b15 … b8 ]   芯片B
[ b7  … b0 ]   芯片A

A0 ~ A7 → 所有芯片
A8 ~ A9 → 译码器 → 选芯片组
```
### 错题
> 假定用若干个 2kx4 位的芯片组成一个 8kx8 位的存储器，则地址 0B1FH 所在芯片的最小地址是（ ）。
	A.0000H       B.0600H       C.0700H       D.0800H
- 所谓所在芯片的最小地址，指的是该地址所在芯片**组**的首地址（不用考虑位扩展所得的具体芯片，因为其地址是复用的）
- 由此可知，需要得出每个芯片的地址表示范围
- 由题可得为字扩展4组，位扩展2个，每组地址为$2*2^{10}$ 个，则 地址范围为0800H
- 由此可知该四组芯片的全部范围，为：
	第 0 组：0000H ~ 07FFH
	第 1 组：0800H ~ 0FFFH
	第 2 组：1000H ~ 17FFH
	第 3 组：1800H ~ 1FFFH
- 由此可得出首地址为0800H
> 某容量为 256MB 的存储器由若干 4M×8 位的 DRAM 芯片构成，该 DRAM 芯片的地址引脚和数据引脚总数是（ ）。
	A.19        B.22        C.30        D.36
- 强调DRAM的行列复用
- 由4M可拆成$(2*2^{10})^2$ ，行列复用可视为是等行等宽，则每行/宽都为$2*2^{10}$
- 根据公式 $地址引脚数 = log_{2}(存储单元个数)$ 可得地址引脚数为11
- 数据引脚与位宽相同
> 某计算机使用 4 体交叉编址存储器，假定在存储器总线上出现的主存地址（十进制）序列为 8005，8006，8007，8008，8001，8002，8003，8004，8000，则可能发生访存冲突的地址对是（ ）。
	A.8004 和 8008               B.8002 和 8007
	C.8001 和 8008               D.8000 和 8004
- 模块序号 = 访存地址 % 存储器交叉模块数
- 由此可得  8005，8006，8007，8008，8001，8002，8003，8004，8000
	分别对应：1           2          3           0           1           2           3           0           0
- 由此可得相邻相同的两地址为冲突
> 某计算机主存按字节编址，由 4 个 64M×8 位的 DRAM 芯片采用交叉编址方式构成，并与宽度为 32 位的存储器总线相连，主存每次最多读写 32 位数据。若 double 型变量 x 的主存地址为 804001AH，则读取 x 需要的存储周期数是（ ）
	A.1          B.2          C.3          D.4
- double 64 位，8 字节
- 804001AH 最低二位  10，即 2
- 一个存储周期 意味着可以对所有芯片各读取一个字节
- 存储器每周期会读4个由0~n的连续地址，因此需要 3 轮