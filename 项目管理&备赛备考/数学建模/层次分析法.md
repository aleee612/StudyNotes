# 基本概念

- 通过相互比较确定各准则对于目标的权重，及各方案对于每一条准则的权重，这些权重在人的思维过程中通常是定性的，而在层次分析法中则要给出得到权重的定量方法
- 将方案对准则层的权重及准则层对目标层的权重进行综合，最终确定方案层对目标层的权重
- 如果使用层次分析法，目标层、准则层、方案层结构图需要出现在论文中
# 使用方法

1. 适用问题：对评价类问题打分
2. 确定层级结构
- 确定评价指标形成评价体系，选择最优方案![](https://cdn.nlark.com/yuque/0/2025/png/55421216/1752665474056-b19e3c92-107f-4e19-b3bb-2df09b3de11b.png)

1. 确定权重指标
- 在确定时可以考虑两两比较，在上一组比较的基础上进而推断当前两组的权重![](https://cdn.nlark.com/yuque/0/2025/png/55421216/1752664475510-e21f8c3c-a15d-4d04-bb49-f73cdef36585.png)
- 将矩阵的第`i`行第`j`列元素记为![](https://cdn.nlark.com/yuque/__latex/fc79500df9b56f8f05f025e1a04b3131.svg)

- ![](https://cdn.nlark.com/yuque/__latex/fc79500df9b56f8f05f025e1a04b3131.svg)的含义表示`i`相较于`j`的重要程度
- 当`i == j`时，规定![](https://cdn.nlark.com/yuque/__latex/d27f9d479db65951e83cc72a2d632ca8.svg)
- 当且仅当![](https://cdn.nlark.com/yuque/__latex/1289eed3f372986a774b4d25cec45c3f.svg)时，该矩阵为正互反矩阵

- 对于一致性矩阵，可直接将归一化的值作为权重
- 对于非一致性矩阵，使用算术平均法求权重，特征值法求权重（重点，建议使用。为了凑字数也可以两种都用然后求平均值）

- ![](https://cdn.nlark.com/yuque/0/2025/png/55421216/1752666897628-56f756bf-afb6-41bc-b6cb-e780a62f3944.png)

4. 确定待选方案在某一指标的得分
5. 确定最终得分

- 最终得分 = 该方案在指标1的得分*指标1的权重+该方案在指标2的得分*指标2的权重+...

# 注意事项

### 一致矩阵和不一致矩阵

- 矩阵中会出现不合逻辑、矛盾的情况，我们称为不一致，对应的判断矩阵就是不一致矩阵
- 一致矩阵的性质：

- A的秩为1，A的唯一非零特征根为n（即只要满足两两行/列成倍数关系，就是一致性矩阵）
- A的任一列向量都是对于特征根n的特征向量

- 判断方法：

- 秩为1，唯一非零特征根为n
- 任一列向量都是对于特征根n的特征向量
- 为不一致矩阵时，最大特征根![](https://cdn.nlark.com/yuque/__latex/ab1820b6d4b78d7fcebf761443768bb2.svg)，![](https://cdn.nlark.com/yuque/__latex/e520c061a407db472027709bf3f73290.svg)与 n 相差越大，其不一致程度越大

- 在**使用判断矩阵之前要先验证其一致性**
- 检验方法：

- 检验指标：![](https://cdn.nlark.com/yuque/__latex/126bd113227c539b1b1bdd172e185b5b.svg)
- RI ：随机一致性指标,多数为直接查资料所得
- 先构造500个判断矩阵![](https://cdn.nlark.com/yuque/__latex/abb290dbcc5ad98d4c80d9eca6266dc4.svg)，分别计算其![](https://cdn.nlark.com/yuque/__latex/fd107497491a583f9ff20dfc6609549c.svg)，于是得到其对应的一致性指标![](https://cdn.nlark.com/yuque/__latex/550c88d1548834adae343d0622187411.svg)，![](https://cdn.nlark.com/yuque/__latex/f8be4a3ddfaee7abef864141c761bbc1.svg)
- 定义一致性比例![](https://cdn.nlark.com/yuque/__latex/05713c12ae414da818b1b23c5d9a8cf7.svg)，如果 CI <0.1，则可认为判断矩阵一致性可以接受，否则需要对判断矩阵进行修正

- ---

# 上机代码
- 使用到的方法：
	- [[语法/matlab/基础语法#^4b0668|sum()]]
	- [[语法/matlab/基础语法#^5f82fc|repmat()]]
```matlab
disp('获取判断矩阵')
A = input('A=');
[n,n]=size(A) % 获取A的大小方便计算

% A = [1 2 5;1/2 1 2;1/5 1/2 1]

% 方法1：算数平均法求权重
Sum_A = sum(A); % 将矩阵按列求和得到的行向量
SUM_A = repmat(Sum_A,n,1); % 将按列求和的行向量复制n列
Stand_A = A ./ SUM_A; 
w1 = sum(Stand_A,2)./n; % 按行相加后的结果分别点除n所得出的就是算数平均值，也就是最后的权重

% 方法2：特征值法求权重
[V,D] = eig(A) % 对A的全部特征值，构成对角阵D，并求A的特征向量构成V的列向量
Max_eig = max(max(D)); % 先按列求最大值得到一个行向量，再从这个向量中求最大值
[r,c] = find(D == Max_eig , 1); % 返回最大特征值的位置
w2 = V(:,c) ./ sum(V(:,c)); % 归一化得出权重

% 两种方法的平均值
w = (w1 + w2) ./ 2;

% 计算一致性比例CR
CI = (Max_eig - n) / (n - 1);
RI = [0 0.0001 0.52 0.89 1.12 1.26 1.36 1.41 1.46 1.49 1.52 1.54 1.56 1.58 1.59]
% RI最多支持n = 15，注意检查
% RI查表得出
% n = 2时，RI = 0，为了避免分母为0，将其改为很接近0 的正数s
CR = CI / RI(n);

disp('最大特征值为');disp(Max_eig)
disp('一致性指标CI=');disp(CI)
disp('一致性比例CR=');disp(CR)

if CR<0.10
    disp('可以接受')
else
    disp('不能接受')
end;
```

