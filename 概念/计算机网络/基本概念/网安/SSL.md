---
aliases:
  - 安全套阶字层
  - 运输层安全性
  - TLS
---
- TCP的强化版本，位于运输层与应用层之间
- URL 以 https 为开头
- 总共三个阶段：握手，密钥输出，数据传输
### 握手
![[Pasted image 20251124084816.png]]
- 总计为3个[[往返时间（RTT）|RTT]] 
##### 1. 创建TCP连接：三次握手
- 详细可见：[[Web和HTTP#三次握手|三次握手]]
##### 2. 验证接收方真实性
1. 发送方向接收方发送SSL hello报文
2. 接收方用证书相应，其中包含接收方公钥
##### 3. 发送给接收方一个主密钥MS
1. 发送方产生一个主密钥MS，发送$K_{B}^+(MS)$ 
2. 接收方使用$K_{B}^-$ 解 $K_{B}^+(MS)$ 得出MS
### 密钥导出
- 在双方均得到主密钥后，双方可以通过其加密之后的所有对话
- 但出于安全，选择使用主密钥生成发送方和接收方的对于加密和完整性检查的不同密钥（四个）：
	- $E_{A}$ 、$E_{B}$ ：接收/发送方的**会话加密**密钥 -> 加密
	- $M_{A}$ 、$M_{B}$ ：接收/发送方的**会话MAC**密钥 -> 完整性
### 数据传输
1. TCP为字节流协议
2. 将数据分割为记录，对于每一个记录，进行：
	- $E_{A}(m+H(M_{A}+m))$ 
	- 其中$H(M_{A}+m)$ 为MAC
3. 出于安全考虑，可能同时将[[序号和确认号|TCP序号]]加入MAC中
### SSL记录
![[Pasted image 20251124181309.png]]
- 类型：该字段用于握手or数据
- 长度：用于提取SSL记录
### 连接关闭
- 发送方直接终止底层TCP连接来结束该会话
- 不安全，为截断攻击创造了条件
- 改良：通过记录的类型字段表明是否为终止对话而非简单[[运输服务（协议）#关闭连接|TCP FIN]] 
