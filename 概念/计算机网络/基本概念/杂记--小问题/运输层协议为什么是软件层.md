#### 首先明白：什么是软硬件层？
| 通常与**硬件**强相关的任务                     | 通常与**软件**强相关的任务                     |
| ----------------------------------- | ----------------------------------- |
| **编码**：将比特流转换为物理信号（如曼彻斯特编码、4B/5B编码） | **[[操作系统内核]]**：实现TCP/IP协议栈、socket接口     |
| **检测**：差错检测（如CRC计算）、信号质量监测          | **驱动程序**：作为操作系统和硬件之间的“翻译官”，控制硬件行为   |
| **解码**：将物理信号还原为比特流                  | **协议逻辑**：实现连接管理（如TCP三次握手）、流量控制、路由决策 |
| **信号的发送与接收**（网卡、天线）                 | **应用程序**：如浏览器、微信等最终使用网络的程序          |
- 我们所谓的运输层“协议”，本质是一个规则/协议，其中**决策、管理、逻辑控制**的功能是硬件（比如网卡）**无法独立完成**的。硬件擅长的是高速、底层的比特流传输，但它不擅长做复杂的判断和状态管理。
### 所以我们运输层协议主要运行在哪里呢？
- 答：[[操作系统内核]]中实现的[[网络协议栈软件]]

> 当在电脑上运行一个程序（比如浏览器）时：
> 1. **应用程序（软件）**：浏览器说：“我要从`www.example.com`下载一个网页”。
> 2. **运输层（软件）**：操作系统的TCP/IP协议栈软件开始工作：
    将网页请求数据**封装**成一个或多个TCP段。
    为每个段添加TCP头部。
    通过系统调用，将这个段交给下层的**网络层（IP层）**。
 3. **网络层及以下（软件+硬件）**：IP层再加装自己的头部，然后通过驱动程序交给**网卡（硬件）**。网卡最终将数字信号转换成电信号或光信号，通过网线**物理地发送**出去。

- 所以“运输”这个动作实际上包含了**软件的处理**和**硬件的发送**两个部分。而“运输层协议是软件层”特指的是前面那一大堆复杂的**封装、管理、决策**工作是由软件完成的。