---
aliases:
  - 内容分发网
  - CDN
---
- 分布在多个地理位置上的服务器
- 服务器中存储视频
- 可以是专用CDN（由内容提供商自己拥有）也可以是第三方CDN（代表多个内容提供商分发内容）
- ---
### 服务器安置原则
#### 深入
- 通过在遍及全球的接入ISP中部署服务器来**深入**到ISP的接入网中
- 目标是**靠近端用户**，减少链路和路由器的数量
- 维护和管理偏难
#### 邀请做客
- 通过在少量关键位置建造大集群来**邀请**到ISP做客，而非将集群接入ISP中
- 集群位置一般在因特网交换点（[[IXP]]）
- 维护和开销低，以对端用户的较高时延和较低吞吐量为代价
- ---
### CDN操作
1. 确定此时适合用于客户的CDN服务器集群
2. 将客户的请求重定向到该集群的某台服务器
- 大多数CDN利用[[DNS：目录服务|DNS]]来截获和重定向要求
#### 如何涉及DNS？
![[Pasted image 20251006131516.png]]
1. 每个视频都被分配了一个URL
2. 在网站获得视频URL后，将从本地DNS服务器向视频的权威服务器处得到一个视频主机域的主机名（例如图中的KingCDN），从此时起DNS请求进入了KingCDN专用DNS基础设施
3. 用户的本地DNS向KingCDN服务器发送第二个请求，由此得到KingCDN内容分发服务器的IP地址
4. 本地DNS服务器向用户主机发送服务内容服务器的IP地址
5. 本机向内容分发服务器创建[[TCP]]连接，并发出对该视频的HTTP GET请求（若使用了[[HTTP流和DASH|DASH]]，服务器将向客户发送具有URL列表的告示文件，每个URL对应不同版本视频，用户可动态选择来自不同版本的块）
### 集群选择策略
- 目的：动态地将客户定向到CDN中的某个服务器集群或数据中心
- 基于：经客户的DNS查找得知客户的**本地DNS服务器**的IP地址
#### 地理上最为接近
- 使用商用地理位置数据库，选择地理上最为接近的集群
- 缺陷：对于使用远地的本地DNS服务器的端用户不友好
#### 基于当前流量条件为客户决定
- 对集群和客户之间的时延和丢包执行周期性的实时测量
- 缺点：许多本地DNS服务器被配置为不会响应这些探测