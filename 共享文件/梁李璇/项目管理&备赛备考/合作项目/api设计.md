好的，我们专注于接口设计规范，不再带入人名。

在设计前后端交互的 API 接口时，一套**统一、清晰、可预测**的响应格式至关重要。这能够极大简化前端的逻辑处理，并提升后端的维护性。

这里我们讨论一种现代、推荐的 **JSON 响应格式**，以及设计中应考虑的几个关键字段。

---

### 推荐的统一 JSON 响应格式

一个好的统一响应体通常包含以下几个核心字段：

```json
{
  "code": 0,
  "message": "string",
  "data": {}
}
```

| 字段名 | 类型 | 描述 | 示例值 |
| :--- | :--- | :--- | :--- |
| **`code`** | Integer (整数) | **业务状态码**，用于标识本次业务操作的结果。**绝不使用 HTTP Status Code**。 | `0` (成功), `1001` (用户名不存在), `2004` (弹幕内容非法) |
| **`message`** | String (字符串) | **对业务状态的描述**。在成功时提供额外信息，在失败时提供错误原因。 | `"登录成功"`、`"密码错误，请重试"` |
| **`data`** | Object/Array (对象/数组) | **核心业务数据**。只有当 `code` 表示成功时，该字段才包含有效数据。 | `{ "token": "...", "room_name": "...", "list": [...] }` |

---

### 1. 核心字段设计 (Code, Message, Data)

#### a. `code` (业务状态码) 的作用和约定

*   **目的：** 明确告诉前端**业务逻辑层面**是成功还是失败，以及失败的具体原因。
*   **约定：**
    *   **`0` (或 `200`)：** 约定为**操作成功**。
    *   **非 `0`：** 约定为**操作失败**，并且应该**分模块编号**。
        *   例如：`1xxx` 用于**用户/认证** (如 1001: 密码错误)。
        *   例如：`2xxx` 用于**会议室/弹幕** (如 2001: 房间不存在)。
        *   例如：`9xxx` 用于**系统/未知错误** (如 9001: 服务器内部错误)。
*   **好处：** 前端在收到响应后，首先判断 `code`，只有当 `code` 为 `0` 时才去解析 `data`。失败时，可以直接根据 `code` 决定展示哪种提示语。

#### b. `message` (描述信息) 的作用

*   **目的：** 提供**人类可读**的提示信息，可以直接展示给用户。
*   **约定：** 无论是成功还是失败，都应该有 `message`。
    *   **成功：** `"创建会议室成功"`。
    *   **失败：** `"您没有权限进行此操作"`。

#### c. `data` (业务数据) 的作用

*   **目的：** 承载本次 API 调用的**核心结果**。
*   **约定：** 必须是 **JSON 对象**或 **JSON 数组**。如果成功但无数据返回（如 DELETE 操作），`data` 可以是空对象 `{}` 或空数组 `[]`，也可以直接不返回 `data` 字段（但不推荐，保持格式统一为佳）。

---

### 2. 区分 HTTP Status Code 与 业务 Code

这是新手常犯的错误。HTTP 状态码（如 200, 404, 500）和您的业务 `code` **应该分开使用**。

| 状态码类型 | 作用 | 示例 | 前端处理 |
| :--- | :--- | :--- | :--- |
| **HTTP Status Code** | 表示**网络传输和服务器处理**的状态，由 Web 服务器和框架管理。 | `200 OK` (请求已成功), `401 Unauthorized` (权限不足), `404 Not Found` (接口不存在), `500 Internal Error` (服务器内部异常) | **只判断是否能继续处理：** 只要是 `2xx`，前端就继续解析响应体；如果是 `4xx/5xx`，通常直接进行全局错误提示。 |
| **业务 Code** | 表示**业务逻辑**的结果，由您（后端）自定义。 | `0` (成功), `1001` (密码错误), `2003` (房间已满) | **判断操作结果：** 只有 `code == 0` 时，才处理 `data`。 |

**✅ 最佳实践：**

*   **请求成功抵达服务器并处理完毕：** 统一返回 **HTTP 200 OK**，然后在响应体内使用您的**业务 `code`** 来指示登录失败、参数错误等业务问题。
*   **服务器或权限问题：** 对于像 `401 Unauthorized`（Token 无效/过期）、`404 Not Found`（URL 错误）和 `500 Internal Error`（后端代码崩溃）这类错误，可以直接返回对应的 HTTP 状态码，此时**响应体可以简化**或直接返回标准的 HTTP 错误格式。

### 3. 接口示例

#### 示例 1：登录接口 (成功)

```json
// POST /api/v1/auth/login
// HTTP Status: 200 OK
{
  "code": 0,
  "message": "登录成功，欢迎回来！",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_in": 3600,
    "user_id": 1024,
    "username": "DawnLinkUser"
  }
}
```

#### 示例 2：登录接口 (业务失败)

```json
// POST /api/v1/auth/login
// HTTP Status: 200 OK
{
  "code": 1002,
  "message": "用户名或密码错误，请检查输入",
  "data": {}
}
```

#### 示例 3：获取房间列表 (成功)

```json
// GET /api/v1/rooms?page=1&size=10
// HTTP Status: 200 OK
{
  "code": 0,
  "message": "房间列表获取成功",
  "data": {
    "total_count": 55,
    "current_page": 1,
    "list": [
      { "id": 1, "name": "新番吐槽大会", "online_users": 15 },
      { "id": 2, "name": "MAD制作交流室", "online_users": 5 }
    ]
  }
}
```